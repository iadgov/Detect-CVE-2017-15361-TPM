<check_type	: "Windows" version : "2">
<group_policy	: "CVE-2017-15361 aka Return of Coppersmith's Attack (ROCA) aka Infineon RSA key generation vulnerability">

<custom_item>
 type		: AUDIT_POWERSHELL
 description	: "Checks Windows systems for enabled Trusted Platform Modules (TPM) that are vulnerable to CVE-2017-15361 aka Return of Coppersmith's Attack (ROCA) aka Infineon RSA key generation vulnerability. Requires PowerShell 2.0 be installed on the systems that are getting scanned."
 info		: "See the following web sites for more information about the vulnerability: and mitigations for TPMs that are vulnerable to CVE-2017-15361:

		https://www.kb.cert.org/vuls/id/307015
		https://www.infineon.com/cms/en/product/promopages/rsa-update/
		https://www.infineon.com/cms/en/product/promopages/rsa-update/rsa-background
		https://www.infineon.com/cms/en/product/promopages/tpm-update/
		
		See the following web sites for more information about operating system patches and TPM firmware updates:
		
		https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/ADV170012
		https://us.answers.acer.com/app/answers/detail/a_id/51137
		http://www.fujitsu.com/global/support/products/software/security/products-f/ifsa-201701e.html
		https://support.hp.com/us-en/document/c05792935
		https://support.hpe.com/hpsc/doc/public/display?docId=emr_na-hpesbhf03789en_us
		https://support.lenovo.com/us/en/product_security/LEN-15552
		https://support.toshiba.com/sscontent?contentId=4015874
        "
 value_type	: POLICY_TEXT
 value_data	: "False"
 check_type	: CHECK_EQUAL
 powershell_args: "IAAKACAAIAAgACAAJAB2AHUAbABuAGUAcgBhAGIAbABlACAAPQAgACQAZgBhAGwAcwBlAAoACgAgACAAIAAgAHQAcgB5ACAAewAKACAAIAAgACAAIAAgACAAIAAkAHYAdQBsAG4AZQByAGEAYgBsAGUAIAA9ACAAQAAoAEcAZQB0AC0AVwBpAG4ARQB2AGUAbgB0ACAALQBGAGkAbAB0AGUAcgBIAGEAcwBoAFQAYQBiAGwAZQAgAEAAewBQAHIAbwB2AGkAZABlAHIATgBhAG0AZQA9ACcATQBpAGMAcgBvAHMAbwBmAHQALQBXAGkAbgBkAG8AdwBzAC0AVABQAE0ALQBXAE0ASQAnADsASQBkAD0AMQA3ADkANAA7AEwAZQB2AGUAbAA9ADIAfQAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQApAC4AQwBvAHUAbgB0ACAALQBnAHQAIAAwAAoAIAAgACAAIAB9ACAAYwBhAHQAYwBoACAAewB9AAoACgAgACAAIAAgAGkAZgAgACgAIQAkAHYAdQBsAG4AZQByAGEAYgBsAGUAKQAgAHsACgAgACAAIAAgACAAIAAgACAAJAB0AHAAbQAgAD0AIAAkAG4AdQBsAGwACgAKACAAIAAgACAAIAAgACAAIAB0AHIAeQAgAHsACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAHQAcABtACAAPQAgAEcAZQB0AC0AVwBtAGkATwBiAGoAZQBjAHQAIAAtAEMAbABhAHMAcwAgACcAVwBpAG4AMwAyAF8AVABQAE0AJwAgAC0ATgBhAG0AZQBzAHAAYQBjAGUAIAAnAHIAbwBvAHQALwBjAGkAbQB2ADIALwBTAGUAYwB1AHIAaQB0AHkALwBNAGkAYwByAG8AcwBvAGYAdABUAFAATQAnACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAGkAbABlAG4AdABsAHkAQwBvAG4AdABpAG4AdQBlAAoAIAAgACAAIAAgACAAIAAgAH0AIABjAGEAdABjAGgAIAB7AH0ACgAKACAAIAAgACAAIAAgACAAIABpAGYAIAAoACQAdABwAG0AIAAtAG4AZQAgACQAbgB1AGwAbAApACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAoACQAdABwAG0ALgBNAGEAbgB1AGYAYQBjAHQAdQByAGUAcgBJAGQAIAAtAGUAcQAgADAAeAA0ADkANAA2ADUAOAAwADAAKQAgAHsACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAJAB0AHAAbQAuAE0AYQBuAHUAZgBhAGMAdAB1AHIAZQByAFYAZQByAHMAaQBvAG4ALgBMAGUAbgBnAHQAaAAgAC0AZwBlACAAMwApACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAHYAZQByAHMAaQBvAG4AIAA9ACAAWwBTAHkAcwB0AGUAbQAuAFYAZQByAHMAaQBvAG4AXQAkAHQAcABtAC4ATQBhAG4AdQBmAGEAYwB0AHUAcgBlAHIAVgBlAHIAcwBpAG8AbgAKAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdwBpAHQAYwBoACAAKAAkAHYAZQByAHMAaQBvAG4ALgBNAGEAagBvAHIAKQAgAHsACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAA0ACAAewAkAHYAdQBsAG4AZQByAGEAYgBsAGUAIAA9ACAAKAAkAHYAZQByAHMAaQBvAG4ALgBNAGkAbgBvAHIAIAAtAGwAZQAgADMAMwAgAC0AbwByACAAQAAoADQAMAAuAC4ANAAyACkAIAAtAGMAbwBuAHQAYQBpAG4AcwAgACQAdgBlAHIAcwBpAG8AbgAuAE0AaQBuAG8AcgApADsAYgByAGUAYQBrAH0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAA1ACAAewAkAHYAdQBsAG4AZQByAGEAYgBsAGUAIAA9ACAAKAAkAHYAZQByAHMAaQBvAG4ALgBNAGkAbgBvAHIAIAAtAGwAZQAgADYAMQApADsAYgByAGUAYQBrAH0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAA2ACAAewAkAHYAdQBsAG4AZQByAGEAYgBsAGUAIAA9ACAAKAAkAHYAZQByAHMAaQBvAG4ALgBNAGkAbgBvAHIAIAAtAGwAZQAgADQAMgApADsAYgByAGUAYQBrAH0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAA3ACAAewAkAHYAdQBsAG4AZQByAGEAYgBsAGUAIAA9ACAAKAAkAHYAZQByAHMAaQBvAG4ALgBNAGkAbgBvAHIAIAAtAGwAZQAgADYAMQApADsAYgByAGUAYQBrAH0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAxADMAMwAgAHsAJAB2AHUAbABuAGUAcgBhAGIAbABlACAAPQAgACgAJAB2AGUAcgBzAGkAbwBuAC4ATQBpAG4AbwByACAALQBsAGUAIAAzADIAKQA7AGIAcgBlAGEAawB9AAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAZABlAGYAYQB1AGwAdAAgAHsAJAB2AHUAbABuAGUAcgBhAGIAbABlACAAPQAgACQAZgBhAGwAcwBlADsAYgByAGUAYQBrAH0AIAAgAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9ACAACgAgACAAIAAgACAAIAAgACAAfQAKACAAIAAgACAAfQAKACAAIAAgACAAJAB2AHUAbABuAGUAcgBhAGIAbABlAAoA"
 ps_encoded_args: YES
 only_show_cmd_output: NO
 severity:	HIGH
</custom_item>

</group_policy>
</check_type>