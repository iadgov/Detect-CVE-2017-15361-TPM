<check_type	: "Windows" version : "2">
    <group_policy	: "Detects Windows systems that have an enabled Trusted Platform Module (TPM) that is vulnerable to CVE-2017-15361 aka Return of Coppersmith's Attack (ROCA) aka Infineon RSA key generation vulnerability">
        <custom_item>
            type: AUDIT_POWERSHELL
            description: "Detects Windows systems that have an enabled Trusted Platform Module (TPM) that is vulnerable to CVE-2017-15361 aka Return of Coppersmith's Attack (ROCA) aka Infineon RSA key generation vulnerability. Requires that PowerShell 2.0 is installed on the systems that are scanned. Tested on Windows 7 and later."
            info: "
                See the following web sites for more information about the vulnerability:

                    https://www.kb.cert.org/vuls/id/307015
		            https://www.infineon.com/cms/en/product/promopages/rsa-update/
		            https://www.infineon.com/cms/en/product/promopages/rsa-update/rsa-background
		            https://www.infineon.com/cms/en/product/promopages/tpm-update/
		
		        See the following web sites for more information on operating system patches and TPM firmware updates:
		
		            https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/ADV170012
		            https://us.answers.acer.com/app/answers/detail/a_id/51137
		            http://www.fujitsu.com/global/support/products/software/security/products-f/ifsa-201701e.html
		            https://support.hp.com/us-en/document/c05792935
		            https://support.hpe.com/hpsc/doc/public/display?docId=emr_na-hpesbhf03789en_us
		            https://support.lenovo.com/us/en/product_security/LEN-15552
		            https://support.toshiba.com/sscontent?contentId=4015874
                  "
            value_type: POLICY_TEXT
            value_data: "False"
            check_type: CHECK_EQUAL
            powershell_args: "JAB2AHUAbABuAGUAcgBhAGIAbABlACAAPQAgACQAZgBhAGwAcwBlAA0ACgANAAoAIAAgACAAIAB0AHIAeQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAkAHYAdQBsAG4AZQByAGEAYgBsAGUAIAA9ACAAQAAoAEcAZQB0AC0AVwBpAG4ARQB2AGUAbgB0ACAALQBGAGkAbAB0AGUAcgBIAGEAcwBoAFQAYQBiAGwAZQAgAEAAewBQAHIAbwB2AGkAZABlAHIATgBhAG0AZQA9ACcATQBpAGMAcgBvAHMAbwBmAHQALQBXAGkAbgBkAG8AdwBzAC0AVABQAE0ALQBXAE0ASQAnADsASQBkAD0AMQA3ADkANAA7AEwAZQB2AGUAbAA9ADIAfQAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQApAC4AQwBvAHUAbgB0ACAALQBnAHQAIAAwAA0ACgAgACAAIAAgAH0AIABjAGEAdABjAGgAIAB7AH0ADQAKAA0ACgAgACAAIAAgAGkAZgAgACgAIQAkAHYAdQBsAG4AZQByAGEAYgBsAGUAKQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAkAHQAcABtACAAPQAgACQAbgB1AGwAbAANAAoADQAKACAAIAAgACAAIAAgACAAIAB0AHIAeQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAdABwAG0AIAA9ACAARwBlAHQALQBXAG0AaQBPAGIAagBlAGMAdAAgAC0AQwBsAGEAcwBzACAAJwBXAGkAbgAzADIAXwBUAFAATQAnACAALQBOAGEAbQBlAHMAcABhAGMAZQAgACcAcgBvAG8AdAAvAGMAaQBtAHYAMgAvAFMAZQBjAHUAcgBpAHQAeQAvAE0AaQBjAHIAbwBzAG8AZgB0AFQAUABNACcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAaQBsAGUAbgB0AGwAeQBDAG8AbgB0AGkAbgB1AGUADQAKACAAIAAgACAAIAAgACAAIAB9ACAAYwBhAHQAYwBoACAAewB9AA0ACgANAAoAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAJAB0AHAAbQAgAC0AbgBlACAAJABuAHUAbABsACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGYAKAAkAHQAcABtAC4ATQBhAG4AdQBmAGEAYwB0AHUAcgBlAHIASQBkACAALQBlAHEAIAAwAHgANAA5ADQANgA1ADgAMAAwACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAJAB0AHAAbQAuAE0AYQBuAHUAZgBhAGMAdAB1AHIAZQByAFYAZQByAHMAaQBvAG4ALgBMAGUAbgBnAHQAaAAgAC0AZwBlACAAMwApACAAewANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAdgBlAHIAcwBpAG8AbgAgAD0AIABbAFMAeQBzAHQAZQBtAC4AVgBlAHIAcwBpAG8AbgBdACQAdABwAG0ALgBNAGEAbgB1AGYAYQBjAHQAdQByAGUAcgBWAGUAcgBzAGkAbwBuAA0ACgANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdwBpAHQAYwBoACAAKAAkAHYAZQByAHMAaQBvAG4ALgBNAGEAagBvAHIAKQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgADQAIAB7ACQAdgB1AGwAbgBlAHIAYQBiAGwAZQAgAD0AIAAoACQAdgBlAHIAcwBpAG8AbgAuAE0AaQBuAG8AcgAgAC0AbABlACAAMwAzACAALQBvAHIAIABAACgANAAwAC4ALgA0ADIAKQAgAC0AYwBvAG4AdABhAGkAbgBzACAAJAB2AGUAcgBzAGkAbwBuAC4ATQBpAG4AbwByACkAOwBiAHIAZQBhAGsAfQANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANQAgAHsAJAB2AHUAbABuAGUAcgBhAGIAbABlACAAPQAgACgAJAB2AGUAcgBzAGkAbwBuAC4ATQBpAG4AbwByACAALQBsAGUAIAA2ADEAKQA7AGIAcgBlAGEAawB9AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAA2ACAAewAkAHYAdQBsAG4AZQByAGEAYgBsAGUAIAA9ACAAKAAkAHYAZQByAHMAaQBvAG4ALgBNAGkAbgBvAHIAIAAtAGwAZQAgADQAMgApADsAYgByAGUAYQBrAH0ADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgADcAIAB7ACQAdgB1AGwAbgBlAHIAYQBiAGwAZQAgAD0AIAAoACQAdgBlAHIAcwBpAG8AbgAuAE0AaQBuAG8AcgAgAC0AbABlACAANgAxACkAOwBiAHIAZQBhAGsAfQANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAMQAzADMAIAB7ACQAdgB1AGwAbgBlAHIAYQBiAGwAZQAgAD0AIAAoACQAdgBlAHIAcwBpAG8AbgAuAE0AaQBuAG8AcgAgAC0AbABlACAAMwAyACkAOwBiAHIAZQBhAGsAfQANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAZABlAGYAYQB1AGwAdAAgAHsAJAB2AHUAbABuAGUAcgBhAGIAbABlACAAPQAgACQAZgBhAGwAcwBlADsAYgByAGUAYQBrAH0AIAAgAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9ACAADQAKACAAIAAgACAAIAAgACAAIAB9AA0ACgAgACAAIAAgAH0ADQAKACAAIAAgACAAJAB2AHUAbABuAGUAcgBhAGIAbABlAA=="
            ps_encoded_args: YES
            only_show_cmd_output: NO
            severity: HIGH
        </custom_item>
    </group_policy>
</check_type>